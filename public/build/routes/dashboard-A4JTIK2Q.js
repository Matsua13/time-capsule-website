import{d as g,e as D,i as N}from"/build/_shared/chunk-KP7ZQPHC.js";import{a as S,b as F}from"/build/_shared/chunk-HK5NTY5D.js";import{a as U}from"/build/_shared/chunk-PGOH7JLP.js";import{a as R,b as h}from"/build/_shared/chunk-4HXKWYDW.js";import{c as i}from"/build/_shared/chunk-Q3IECNXJ.js";var T=i(U(),1),$=i(S(),1),A=i(F(),1);var l=i(h(),1),M=({capsules:r})=>{let o=[...r].sort((s,c)=>new Date(c.scheduledDate).getTime()-new Date(s.scheduledDate).getTime());return(0,l.jsx)("div",{children:(0,l.jsx)("ul",{style:{listStyle:"none",paddingLeft:0},children:o.map(s=>(0,l.jsx)("li",{style:{marginBottom:"20px",position:"relative"},children:(0,l.jsxs)("div",{style:{borderLeft:"2px solid #333",paddingLeft:"15px"},children:[(0,l.jsx)("h4",{children:s.title}),(0,l.jsx)("p",{children:new Date(s.scheduledDate).toLocaleString()})]})},s.id))})})},C=M;var n=i(h(),1);function v({capsules:r}){let o=new Date,s=o.getUTCFullYear(),c=o.getUTCMonth(),m=o.getUTCDate(),b=o.toLocaleString("default",{month:"long"}),x=new Date(s,c+1,0).getUTCDate(),y=r.map(a=>{let d=new Date(a.scheduledDate);return d.getUTCFullYear()===s&&d.getUTCMonth()===c?d.getUTCDate():null}).filter(a=>a!==null),u=new Date(Date.UTC(s,c,1)).getUTCDay(),p=[];for(let a=0;a<u;a++)p.push(null);for(let a=1;a<=x;a++)p.push(a);return(0,n.jsxs)("div",{className:"p-4 bg-white rounded-3xl shadow-xl border-4 border-slate-300",children:[(0,n.jsxs)("h3",{className:"text-xl font-semibold mb-2 text-center",children:[b," ",s]}),(0,n.jsxs)("div",{className:"grid grid-cols-7 gap-2 text-center",children:[["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map(a=>(0,n.jsx)("div",{className:"font-bold",children:a},a)),p.map((a,d)=>(0,n.jsx)("div",{className:"h-12 flex items-center justify-center border border-gray-200 rounded",children:a?(0,n.jsxs)("div",{className:`${a===m?"bg-green-200 font-bold rounded-full px-1":""}`,children:[(0,n.jsx)("span",{children:a}),y.includes(a)&&(0,n.jsx)("span",{className:"ml-1",title:"Capsule scheduled",children:"\u{1F48A}"})]}):null},d))]})]})}var f=i(R(),1),e=i(h(),1);function k(){let{capsules:r,user:o,notifications:s,reminders:c}=N(),[m,b]=(0,f.useState)("all"),[x,y]=(0,f.useState)(c);(0,f.useEffect)(()=>{let t=setTimeout(()=>{y([])},6e4);return()=>clearTimeout(t)},[]);let u=r;m==="sent"?u=r.filter(t=>t.ownerId===o.id):m==="received"&&(u=r.filter(t=>t.ownerId!==o.id));let p=new Date,a=u.filter(t=>new Date(t.scheduledDate)>=p),d=u.filter(t=>new Date(t.scheduledDate)<p);return(0,e.jsxs)("div",{className:"min-h-screen p-4 bg-gradient-to-br from-sky-300 to-sky-500 text-gray-900",children:[x.length>0&&(0,e.jsx)("div",{className:"mb-6 p-4 bg-emerald-100 text-emerald-800 rounded",children:x.map(t=>(0,e.jsx)("p",{className:"text-sm",children:t.message},t.id))}),s.length>0&&(0,e.jsx)("div",{className:"mb-6 p-4 bg-amber-100 text-amber-800 rounded",children:s.map(t=>{let w=t.message.match(/^capsule:(\d+):\s*(.*)/);if(w){let I=w[1],L=w[2];return(0,e.jsx)("p",{className:"text-sm",children:(0,e.jsx)("a",{href:`/notification?capsuleId=${I}&notifId=${t.id}`,className:"hover:underline",children:L})},t.id)}else return(0,e.jsx)("p",{className:"text-sm",children:t.message},t.id)})}),(0,e.jsxs)("div",{className:"flex justify-between items-center mb-8",children:[(0,e.jsx)("h1",{className:"text-5xl font-extrabold drop-shadow-xl",children:"Dashboard"}),(0,e.jsx)(D,{method:"post",action:"/logout",children:(0,e.jsx)("button",{type:"submit",className:"bg-red-500 text-white px-4 py-2 rounded hover:bg-red-600 transition",children:"Log out"})})]}),(0,e.jsx)("section",{className:"flex justify-center mb-8",children:(0,e.jsx)(g,{to:"/new",className:"bg-amber-300 hover:bg-amber-500 text-white px-6 py-3 rounded transition",children:"Create a Capsule"})}),(0,e.jsxs)("div",{className:"mb-6 flex space-x-4",children:[(0,e.jsx)("button",{onClick:()=>b("all"),className:`px-4 py-2 rounded transition ${m==="all"?"bg-sky-700 text-white":"bg-gray-200 text-gray-800"}`,children:"All Capsules"}),(0,e.jsx)("button",{onClick:()=>b("sent"),className:`px-4 py-2 rounded transition ${m==="sent"?"bg-sky-700 text-white":"bg-gray-200 text-gray-800"}`,children:"Sent"}),(0,e.jsx)("button",{onClick:()=>b("received"),className:`px-4 py-2 rounded transition ${m==="received"?"bg-sky-700 text-white":"bg-gray-200 text-gray-800"}`,children:"Received"})]}),(0,e.jsxs)("section",{className:"mb-8",children:[(0,e.jsx)("h2",{className:"text-2xl font-semibold mb-4",children:"Upcoming Capsules"}),a.length?(0,e.jsx)("div",{className:"grid gap-4",children:a.map(t=>(0,e.jsxs)("div",{className:"flex justify-between items-center p-4 bg-white rounded shadow hover:bg-gray-100 transition",children:[(0,e.jsxs)("div",{children:[(0,e.jsx)("h3",{className:"text-xl font-semibold",children:(0,e.jsx)(g,{to:`/${t.id}`,className:"text-sky-700 hover:underline",children:t.title})}),(0,e.jsx)("p",{className:"text-sm text-gray-600",children:t.content}),(0,e.jsxs)("p",{className:"text-xs text-gray-500",children:["Opening day: ",new Date(t.scheduledDate).toLocaleString()]})]}),(0,e.jsx)(g,{to:"/delete-capsules",className:"ml-4 text-red-600 hover:text-red-800",title:"Manage capsule deletions",children:"\u{1F5D1}\uFE0F"})]},t.id))}):(0,e.jsx)("p",{children:"No upcoming capsules."})]}),(0,e.jsxs)("section",{className:"mb-8",children:[(0,e.jsx)("h2",{className:"text-2xl font-semibold mb-4",children:"Previous Capsules"}),d.length?(0,e.jsx)("div",{className:"grid gap-4",children:d.map(t=>(0,e.jsxs)("div",{className:"flex justify-between items-center p-4 bg-white rounded shadow hover:bg-gray-100 transition",children:[(0,e.jsxs)("div",{children:[(0,e.jsx)("h3",{className:"text-xl font-semibold",children:(0,e.jsx)(g,{to:`/${t.id}`,className:"text-sky-700 hover:underline",children:t.title})}),(0,e.jsx)("p",{className:"text-sm text-gray-600",children:t.content}),(0,e.jsxs)("p",{className:"text-xs text-gray-500",children:["Opening day: ",new Date(t.scheduledDate).toLocaleString()]})]}),(0,e.jsx)(g,{to:"/delete-capsules",className:"ml-4 text-red-600 hover:text-red-800",title:"Manage capsule deletions",children:"\u{1F5D1}\uFE0F"})]},t.id))}):(0,e.jsx)("p",{children:"No previous capsules."})]}),(0,e.jsxs)("section",{className:"mb-8",children:[(0,e.jsx)("h2",{className:"text-center text-2xl font-semibold mb-4",children:"Visualisations"}),(0,e.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[(0,e.jsxs)("div",{className:"bg-white p-8 rounded-3xl shadow-xl border-4 border-yellow-500",children:[(0,e.jsx)("h3",{className:"text-xl font-semibold mb-2",children:"Timeline"}),(0,e.jsx)(C,{capsules:r})]}),(0,e.jsxs)("div",{className:"bg-white p-8 rounded-3xl shadow-xl border-4 border-yellow-500",children:[(0,e.jsx)("h3",{className:"text-xl font-semibold mb-2",children:"Calendar"}),(0,e.jsx)(v,{capsules:r})]})]})]})]})}export{k as default};
